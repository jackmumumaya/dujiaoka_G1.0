# ç‹¬è§’æ•°å¡ (Lite & SQLite Encrypted Version)

<p align="center"><img src="https://i.loli.net/2020/04/07/nAzjDJlX7oc5qEw.png" width="400"></p>

æœ¬ç‰ˆæœ¬åŸºäºç‹¬è§’æ•°å¡ 2.0.6 è¿›è¡Œæ·±åº¦ä¼˜åŒ–ï¼Œ**å»é™¤äº† Dockerã€Mysqlã€Redis ä¾èµ–**ï¼Œè½¬ä¸ºä½¿ç”¨ **SQLite** æ•°æ®åº“ï¼ˆæ”¯æŒ SQLCipher åŠ å¯†ï¼‰ï¼Œå®ç°äº†æè‡´çš„è½»é‡åŒ–éƒ¨ç½²ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

1.  **è½»é‡åŒ–æ¶æ„**:
    - ç§»é™¤ Docker é‡å‹å®¹å™¨ï¼Œå›å½’åŸç”Ÿ PHP è¿è¡Œã€‚
    - ç§»é™¤ MySQL æ•°æ®åº“ï¼Œè¿ç§»è‡³å•æ–‡ä»¶ SQLiteã€‚
    - ç§»é™¤ Redis ç»„ä»¶ï¼Œé€šè¿‡æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå®ç°ç¼“å­˜ä¸ä¼šè¯ã€‚
    - ç§»é™¤ å¼‚æ­¥é˜Ÿåˆ—ï¼Œæ”¹ä¸ºåŒæ­¥å¤„ç†ï¼Œç®€åŒ–éƒ¨ç½²ã€‚
2.  **æ•°æ®å®‰å…¨**:
    - é›†æˆ **SQLCipher** æ”¯æŒï¼Œå¯å¯¹ SQLite æ•°æ®åº“æ–‡ä»¶è¿›è¡Œé«˜å¼ºåº¦åŠ å¯†ã€‚
    - å³ä½¿æ•°æ®åº“æ–‡ä»¶è¢«ç›—ï¼Œæ— å¯†é’¥ä¹Ÿæ— æ³•è¯»å–æ•°æ®ã€‚
3.  **ä¸€é”®ç®¡ç†**:
    - æä¾› `manage_lite.sh` è„šæœ¬ï¼Œæ”¯æŒ `start`, `stop`, `restart`, `status`, `install`, `encrypt` ç­‰å¸¸ç”¨æ“ä½œã€‚
4.  **å®Œæ•´æ•°æ®è¿ç§»**:
    - å·²å†…ç½®è¿ç§»åçš„ 76 ä¸ªå•†å“åŠç›¸å…³é…ç½®æ•°æ®ã€‚

---

## ğŸ› ï¸ éƒ¨ç½²æŒ‡å— (Linux/macOS)

### 1. ç¯å¢ƒè¦æ±‚

è¯·ç¡®ä¿æœåŠ¡å™¨å·²å®‰è£… **PHP 7.4+** åŠä»¥ä¸‹æ‰©å±•ï¼š

- `php-cli`
- `php-sqlite3` (æˆ–è‡ªè¡Œç¼–è¯‘æ”¯æŒ SQLCipher çš„é©±åŠ¨)
- `php-bcmath`
- `php-mbstring`
- `php-xml`
- `php-curl`
- `openssl`

### 2. å®‰è£…æ­¥éª¤

1.  **è§£å‹å®‰è£…åŒ…**

    ```bash
    tar -zxvf dujiaoka_sqlite_v2.0.6_lite.tar.gz
    cd dujiaoka
    ```

2.  **æ‰§è¡Œåˆå§‹åŒ–**

    ```bash
    chmod +x manage_lite.sh
    ./manage_lite.sh install
    ```

    æ­¤æ­¥éª¤ä¼šè‡ªåŠ¨ï¼š
    - æ£€æŸ¥ç¯å¢ƒä¾èµ–
    - è®¾ç½®ç›®å½•æƒé™ (`storage`, `bootstrap`)
    - ç”Ÿæˆåº”ç”¨å¯†é’¥
    - æ¸…ç†å¹¶é‡å»ºç¼“å­˜

3.  **å¯åŠ¨æœåŠ¡**
    ```bash
    ./manage_lite.sh start
    ```

    - é»˜è®¤ç«¯å£: `8898`
    - è®¿é—®åœ°å€: `http://localhost:8898` (æˆ–æœåŠ¡å™¨ IP)

### 3. æ—¥å¸¸ç®¡ç†å‘½ä»¤

- **åœæ­¢æœåŠ¡**: `./manage_lite.sh stop`
- **é‡å¯æœåŠ¡**: `./manage_lite.sh restart`
- **æŸ¥çœ‹çŠ¶æ€**: `./manage_lite.sh status`

---

## ğŸ”’ æ•°æ®åº“åŠ å¯†æ–¹æ¡ˆ (SQLCipher)

æœ¬ç‰ˆæœ¬æ”¯æŒå¯¹ SQLite æ•°æ®åº“è¿›è¡ŒåŠ å¯†ï¼Œä¿æŠ¤æ‚¨çš„æ•æ„Ÿæ•°æ®ã€‚

### å‰ç½®æ¡ä»¶

- æœåŠ¡å™¨éœ€å®‰è£… `sqlcipher` å‘½ä»¤è¡Œå·¥å…· (ä¾‹å¦‚: `apt install sqlcipher`)ã€‚
- PHP ç¯å¢ƒéœ€æ”¯æŒ SQLite åŠ å¯†è¿æ¥ (é€šå¸¸éœ€è¦ç¼–è¯‘å®‰è£…æˆ–ç‰¹å®šçš„ SQLite æ‰©å±•æ”¯æŒ)ã€‚

### åŠ å¯†æ­¥éª¤

1.  **é…ç½®å¯†é’¥**
    ç¼–è¾‘ `encrypt_db.sh` æ–‡ä»¶ï¼Œä¿®æ”¹ `KEY` å˜é‡ä¸ºæ‚¨æƒ³è¦çš„å¯†ç ï¼š

    ```bash
    KEY="æ‚¨çš„å¼ºå¯†ç "
    ```

2.  **æ‰§è¡ŒåŠ å¯†**
    è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

    ```bash
    ./manage_lite.sh encrypt
    ```

    è„šæœ¬ä¼šè‡ªåŠ¨å°† `database/database.sqlite` åŠ å¯†ï¼Œå¹¶å¤‡ä»½åŸæ–‡ä»¶ä¸º `.bak`ã€‚

3.  **é…ç½®åº”ç”¨**
    ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œè®¾ç½® `DB_PASSWORD` ä¸ºæ‚¨åˆšæ‰è®¾å®šçš„å¯†ç ï¼š

    ```ini
    DB_CONNECTION=sqlite
    DB_DATABASE=database/database.sqlite
    DB_PASSWORD=æ‚¨çš„å¼ºå¯†ç   <-- å¿…é¡»ä¸åŠ å¯†æ—¶çš„ KEY ä¸€è‡´
    ```

4.  **é‡å¯æœåŠ¡**
    ```bash
    ./manage_lite.sh restart
    ```

---

## ğŸ“‚ ç›®å½•ç»“æ„è¯´æ˜

- `database/database.sqlite`: æ ¸å¿ƒæ•°æ®åº“æ–‡ä»¶ (è¯·å®šæœŸå¤‡ä»½)ã€‚
- `manage_lite.sh`: é¡¹ç›®ç®¡ç†ä¸å¯åŠ¨è„šæœ¬ã€‚
- `encrypt_db.sh`: æ•°æ®åº“åŠ å¯†å·¥å…·è„šæœ¬ã€‚
- `.env`: ç¯å¢ƒé…ç½®æ–‡ä»¶ã€‚
- `storage/logs`: è¿è¡Œæ—¥å¿—ç›®å½•ã€‚

---

## License

ç‹¬è§’æ•°å¡ DJK Inc [MIT license](https://opensource.org/licenses/MIT).
